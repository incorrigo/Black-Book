<!-- CorrespondenceEntryWindow.xaml -->
<Window x:Class="BlackBook.Views.CorrespondenceEntryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:BlackBook.Models"
        xmlns:conv="clr-namespace:BlackBook.Converters"
        Title="Enter Correspondence"
        Height="480" Width="580"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Timestamp display -->
            <RowDefinition Height="Auto"/>
            <!-- Person -->
            <RowDefinition Height="Auto"/>
            <!-- Company -->
            <RowDefinition Height="Auto"/>
            <!-- Relationship -->
            <RowDefinition Height="Auto"/>
            <!-- Direction -->
            <RowDefinition Height="Auto"/>
            <!-- Type -->
            <RowDefinition Height="Auto"/>
            <!-- Situation -->
            <RowDefinition Height="*"/>
            <!-- Notes (fills remaining space) -->
            <RowDefinition Height="Auto"/>
            <!-- Buttons -->
            <RowDefinition Height="200"/>
            <!-- History list -->
        </Grid.RowDefinitions>

        <!-- Timestamp (read-only, current time) -->
        <TextBlock x:Name="TimestampText"
                   Grid.Row="0" FontSize="12" HorizontalAlignment="Right" Margin="0 0 0 10"/>

        <!-- Person name -->
        <TextBox x:Name="PersonTextBox"
                 Grid.Row="1" Padding="6" Margin="0 0 0 10"
                 ToolTip="Name of the person this correspondence is with."/>

        <!-- Company name -->
        <TextBox x:Name="CompanyTextBox"
                 Grid.Row="2" Padding="6" Margin="0 0 0 10"
                 ToolTip="Company or organization of the person."/>
        <!-- Relationship (auto-selected based on person if exists) -->
        <ComboBox x:Name="RelationshipComboBox"
                  Grid.Row="3" Padding="6" Margin="0 0 0 10"
                  ToolTip="Your relationship with this person."
                  SelectedIndex="0">
            <ComboBoxItem Content="Unknown"/>
            <ComboBoxItem Content="Friendly"/>
            <ComboBoxItem Content="Neutral"/>
            <ComboBoxItem Content="Adversarial"/>
        </ComboBox>

        <!-- Direction (incoming/outgoing) -->
        <ComboBox x:Name="DirectionComboBox"
                  Grid.Row="4" Padding="6" Margin="0 0 0 10"
                  ToolTip="Whether this correspondence was incoming (received) or outgoing (sent)."
                  SelectedIndex="0">
            <ComboBoxItem Content="Incoming"/>
            <ComboBoxItem Content="Outgoing"/>
        </ComboBox>

        <!-- Interaction Type -->
        <ComboBox x:Name="InteractionTypeComboBox"
                  Grid.Row="5" Padding="6" Margin="0 0 0 10"
                  ToolTip="Type of interaction."
                  SelectedIndex="0">
            <ComboBoxItem Content="Email"/>
            <ComboBoxItem Content="Phone Call"/>
            <ComboBoxItem Content="Text Message"/>
            <ComboBoxItem Content="In-Person Meeting"/>
            <ComboBoxItem Content="Video Conference"/>
            <ComboBoxItem Content="Postal Mail"/>
            <ComboBoxItem Content="Social Media"/>
            <ComboBoxItem Content="Other"/>
        </ComboBox>

        <!-- Situation (editable ComboBox for context) -->
        <ComboBox x:Name="SituationComboBox"
                  Grid.Row="6" Padding="6" Margin="0 0 0 10"
                  IsEditable="True" IsTextSearchEnabled="False"
                  ItemsSource="{Binding Situations}" DisplayMemberPath="Title"
                  ToolTip="Situation or project this correspondence relates to."
                  Text="AdHoc"/>
        <!-- default text for uncategorized correspondence -->

        <!-- Notes (multi-line text) -->
        <TextBox x:Name="NotesTextBox"
                 Grid.Row="7" Padding="6" Margin="0 0 0 10"
                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                 Height="80"
                 ToolTip="Notes or summary of the correspondence."/>

        <!-- Buttons (Cancel/Save) -->
        <Grid Grid.Row="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Button Content="Cancel" Grid.Column="1" Width="90" Margin="0 0 5 0"
                    Click="Cancel_Click" IsCancel="True"/>
            <Button x:Name="SaveButton" Content="Save" Grid.Column="2" Width="90"
                    Click="Save_Click" IsDefault="True"/>
        </Grid>

        <!-- History list of past interactions with this person -->
        <ListBox x:Name="HistoryList"
                 Grid.Row="9" FontSize="12" Padding="4" Margin="0 10 0 0"
                 ToolTip="Previous correspondence with this person (most recent first).">
            <ListBox.ItemTemplate>
                <DataTemplate DataType="{x:Type models:Interaction}">
                    <Grid Margin="0 2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <!-- Relationship glyph of person for quick context -->
                        <TextBlock Grid.Column="0" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Text="{Binding Person.Relationship, Converter={StaticResource RelationshipGlyphConverter}}"/>
                        <!-- Notes preview -->
                        <TextBlock Grid.Column="1" Text="{Binding Notes}" TextWrapping="Wrap"/>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- Button to reply to selected past interaction (prefill form) -->
        <Button x:Name="ReplyButton"
                Content="Send Response"
                Width="120" HorizontalAlignment="Right" Margin="0 8 0 0"
                Grid.Row="9" Click="ReplyToSelected_Click"/>
    </Grid>
</Window>
