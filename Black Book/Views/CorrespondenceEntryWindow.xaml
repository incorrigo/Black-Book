<!-- CorrespondenceEntryWindow.xaml -->
<Window x:Class="BlackBook.Views.CorrespondenceEntryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:BlackBook.Models"
        Title="Enter Correspondence"
        Width="620" Height="540"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterOwner">

    <!-- ╭───────── page margin ─────────╮ -->
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- time‑stamp               -->
            <RowDefinition Height="Auto"/>
            <!-- person / company         -->
            <RowDefinition Height="Auto"/>
            <!-- relation / dir / type    -->
            <RowDefinition Height="Auto"/>
            <!-- situation                -->
            <RowDefinition Height="*"/>
            <!-- notes + history / reply  -->
            <RowDefinition Height="Auto"/>
            <!-- bottom buttons           -->
        </Grid.RowDefinitions>

        <!-- time‑stamp -->
        <TextBlock x:Name="TimestampText"
                   Grid.Row="0"
                   FontSize="12"
                   HorizontalAlignment="Right"
                   Margin="0 0 0 10"/>

        <!-- person / company (stack) -->
        <StackPanel Grid.Row="1" Margin="0 0 0 6">
            <ComboBox x:Name="PersonComboBox"
                      IsEditable="True" ItemsSource="{Binding People}"
                      DisplayMemberPath="Name"/>
            <ComboBox x:Name="CompanyComboBox"
                      Margin="0 6 0 0"
                      IsEditable="True" ItemsSource="{Binding Companies}"
                      DisplayMemberPath="Name"/>
        </StackPanel>

        <!-- relation / dir / type  -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0 0 0 6">
            <ComboBox x:Name="RelationshipComboBox" Width="110" Margin="0 0 6 0"
                      SelectedIndex="0">
                <ComboBoxItem Content="Unknown"/>
                <ComboBoxItem Content="Friendly"/>
                <ComboBoxItem Content="Neutral"/>
                <ComboBoxItem Content="Adversarial"/>
            </ComboBox>

            <ComboBox x:Name="DirectionComboBox"  Width="100" Margin="0 0 6 0"
                      SelectedIndex="0">
                <ComboBoxItem Content="Incoming"/>
                <ComboBoxItem Content="Outgoing"/>
                <ComboBoxItem Content="Mutual"/>
            </ComboBox>

            <ComboBox x:Name="InteractionTypeComboBox" Width="130"
                      SelectedIndex="0">
                <ComboBoxItem Content="Email"/>
                <ComboBoxItem Content="Phone Call"/>
                <ComboBoxItem Content="Text Message"/>
                <ComboBoxItem Content="In‑Person Meeting"/>
                <ComboBoxItem Content="Video Conference"/>
                <ComboBoxItem Content="Postal Mail"/>
                <ComboBoxItem Content="Social Media"/>
                <ComboBoxItem Content="Other"/>
            </ComboBox>
        </StackPanel>

        <!-- situation -->
        <ComboBox x:Name="SituationComboBox"
                  Grid.Row="3"
                  Text="AdHoc"
                  IsEditable="True"
                  ItemsSource="{Binding Situations}"
                  DisplayMemberPath="Title"
                  Margin="0 0 0 6"/>

        <!-- notes + history + reply -->
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="270"/>
            </Grid.ColumnDefinitions>

            <!-- notes -->
            <TextBox x:Name="NotesTextBox"
                     Grid.Column="0"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     VerticalScrollBarVisibility="Auto"/>

            <!-- history + send‑response -->
            <DockPanel Grid.Column="1" Margin="10 0 0 0">
                <ListBox x:Name="HistoryList"
                         DockPanel.Dock="Top"
                         Height="200"
                         FontSize="12">
                    <ListBox.ItemTemplate>
                        <DataTemplate DataType="{x:Type models:Interaction}">
                            <StackPanel Orientation="Horizontal" Margin="0 1">
                                <TextBlock Text="{Binding Timestamp,
                                           StringFormat={}{0:yyyy-MM-dd HH:mm}}"
                                           Margin="0 0 4 0"/>
                                <TextBlock Text="—" Margin="0 0 4 0"/>
                                <TextBlock Text="{Binding Notes}"
                                           Width="160"
                                           TextTrimming="CharacterEllipsis"/>
                                <TextBlock Text="{Binding Converter={StaticResource InteractionPartiesConverter}}"
           Width="160" TextTrimming="CharacterEllipsis"/>

                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <Button x:Name="ReplyButton" Content="Send Response"
                        Margin="0 6 0 0"
                        Click="ReplyToSelected_Click"/>
            </DockPanel>
        </Grid>

        <!-- bottom buttons -->
        <StackPanel Grid.Row="5" Orientation="Horizontal"
                    HorizontalAlignment="Right" Margin="0 10 0 0">
            <Button Content="Cancel" Width="90" Margin="0 0 8 0"
                    Click="Cancel_Click" IsCancel="True"/>
            <Button x:Name="SaveButton" Content="Save" Width="90"
                    Click="Save_Click" IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>
